#!/bin/bash
set -e

FAMILY=quay.io/azavea

PYTORCH_IMAGE=raster-vision-pytorch
PYTORCH_TAG=${FAMILY}/raster-vision:pytorch

CUDA_VERSION="10.0"
BASE_STRING=$(cat Dockerfile.base | md5sum | cut -f1 -d' ')
BASE_IMAGE=${FAMILY}/${PYTORCH_IMAGE}:base-${BASE_STRING}-cuda${CUDA_VERSION}
PYBASE_STRING=$(cat Dockerfile.base Dockerfile.pybase ./docs/requirements.txt ./requirements-dev.txt ./rastervision*/requirements.txt | md5sum | cut -f1 -d' ')
PYBASE_IMAGE=${FAMILY}/${PYTORCH_IMAGE}:pybase-${PYBASE_STRING}
